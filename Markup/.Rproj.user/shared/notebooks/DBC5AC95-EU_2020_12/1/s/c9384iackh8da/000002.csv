"0","theme <-"
"0","  theme_minimal(base_size = 6) +"
"0","  theme(axis.text.x = element_text(angle = 90),"
"0","        legend.position = ""none"",) # EU base theme"
"0","theme_set(theme) # setting ggplot theme instead of using theme function"
"0",""
"0","eu_bar <-"
"0","  function(data,"
"0","           mapping,"
"0","           label,"
"0","           color_count,"
"0","           periodicity = 0.25,"
"0","           scale = scale_x_yearqtr) {"
"0","    bar <-  ggplot(data, mapping) +"
"0","      geom_bar(stat = ""identity"", width = 0.18) +"
"0","      labs(x = """", y = label) +"
"0","      scale_fill_manual(values = pnw_palette(""Winter"", color_count))"
"0","    "
"0","    if (periodicity == 0.25)"
"0","      bar + scale_x_yearqtr(breaks = seq("
"0","        from = min(data$Period),"
"0","        to = max(data$Period),"
"0","        by = periodicity"
"0","      ),"
"0","      format = ""%Y-Q%q"")"
"0","    "
"0","    else"
"0","      bar + scale_x_yearmon(breaks = seq("
"0","        from = min(data$Period),"
"0","        to = max(data$Period),"
"0","        by = periodicity"
"0","      ),"
"0","      format = ""%Y-%b"")"
"0","  } # EU bar ggplot with changing x scales"
"0",""
"0","eu_line <-"
"0","  function(data,"
"0","           mapping,"
"0","           label,"
"0","           color_count,"
"0","           periodicity = 0.25) {"
"0","    bar <-  ggplot(data, mapping) +"
"0","      geom_line() +"
"0","      geom_point(size = 2) +"
"0","      labs(x = """", y = label) +"
"0","      scale_color_manual(values = pnw_palette(""Winter"", color_count))"
"0","    "
"0","    if (periodicity == 0.25)"
"0","      bar + scale_x_yearqtr(breaks = seq("
"0","        from = min(data$Period),"
"0","        to = max(data$Period),"
"0","        by = periodicity"
"0","      ),"
"0","      format = ""%Y-Q%q"")"
"0","    "
"0","    else"
"0","      bar +"
"0","      scale_x_yearmon(breaks = seq("
"0","        from = min(data$Period),"
"0","        to = max(data$Period),"
"0","        by = periodicity"
"0","      ),"
"0","      format = ""%Y-%b"")"
"0","  } # EU line ggplot with changing x scales"
"0",""
"0","oecd_countries <- function(data, start_period = ""2019 Q1""){"
"0","  data %>% "
"0","    filter("
"0","    Country %in% c("
"0","      ""OECD"","
"0","      ""JPN"","
"0","      ""CHN"","
"0","      ""USA"","
"0","      ""BRA"","
"0","      ""DEU"","
"0","      ""IND"","
"0","      ""GBR"","
"0","      ""RUS"","
"0","      ""FRA"""
"0","    ),"
"0","    Unit == ""PC"""
"0","  ) %>%"
"0","  filter(Period > start_period) %>%"
"0","  mutate(Country = str_replace_all("
"0","    Country,"
"0","    c("
"0","      ""DEU"" = ""Germany"","
"0","      ""JPN"" = ""Japan"","
"0","      ""USA"" = ""United States"","
"0","      ""BRA"" = ""Brazil"","
"0","      ""IND"" = ""India"","
"0","      ""RUS"" = ""Russia"","
"0","      ""FRA"" = ""France"""
"0","    )"
"0","  ))"
"0","  "
"0","} # for cleaning OECD data for specified countries"
"0",""
"0","sa_gdp <- function(data, measure = ""Percentage Change"", start_period = ""2019 Q1"" ) {"
"0","  data %>% "
"0","    filter(Unit == measure, Period > start_period)"
"0","} # for sorting SA_GDP data"
"0",""
